@page "/login"

<PageTitle>Login</PageTitle>

<EditForm Model="@credentials" OnValidSubmit="HandleLogin" class="d-flex flex-column gap-3 mt-5 mx-auto" style="max-width: 350px;">
	<DataAnnotationsValidator />

	<h3 class="text-center">Neu LDAP Management</h3>

	<div class="form-group">
		<label class="form-label" for="username">Username</label>
		<InputText class="form-control" id="username" @bind-Value="credentials.Username" />
		<ValidationMessage For="() => credentials.Username" />
	</div>

	<div class="form-group">
		<label class="form-label" for="password">Password</label>
		<InputText class="form-control" id="password" @bind-Value="credentials.Password" type="password" />
		<ValidationMessage For="() => credentials.Password" />
	</div>

	<button type="submit" class="btn btn-primary w-100 mt-2">Login</button>
</EditForm>

@code {
	private LoginModel credentials = new();

	private async Task HandleLogin()
	{
		try
		{
			await ApiRequests.LoginAsync(credentials.Username, credentials.Password);
			NavManager.NavigateTo("/");
		}
		catch (Exception e)
		{
			Console.WriteLine(e.Message);
		}
	}
}

