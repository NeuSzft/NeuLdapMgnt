@if (isAuthenticated)
{
	<Sidebar2 IconName="IconName.Database"
			  Title="LDAP Management"
			  DataProvider="SidebarDataProvider" />
}

@code {
	private Sidebar sidebar = new();
	private List<NavItem>? navItems;

	private bool collapseNavMenu = true;
	private string? NavMenuCssClass => collapseNavMenu ? "collapse" : null;
	private bool isAuthenticated;

	private async Task<Sidebar2DataProviderResult> SidebarDataProvider(Sidebar2DataProviderRequest request)
	{
		if (navItems is null)
			navItems = GetNavItems();

		return await Task.FromResult(request.ApplyTo(navItems));
	}

	private List<NavItem> GetNavItems()
	{
		navItems = new List<NavItem> {
			new NavItem { Id = "1", Href = "/", Match = NavLinkMatch.All, IconName = IconName.HouseDoor, Text = "Home" },

			new NavItem { Id = "10", Text = "Students" },
			new NavItem { Id = "11", Href = "/students", Match = NavLinkMatch.All, IconName = IconName.Table, Text = "View Students", ParentId = "10" },
			new NavItem { Id = "12", Href = "/students/add", Match = NavLinkMatch.All, IconName = IconName.PersonAdd, Text = "Add Student", ParentId = "10" },

			new NavItem { Id = "20", Text = "Teachers" },
			new NavItem { Id = "21", Href = "/teachers", Match = NavLinkMatch.All, IconName = IconName.Table, Text = "View Teachers", ParentId = "20" },
			new NavItem { Id = "22", Href = "/teachers/add", Match = NavLinkMatch.All, IconName = IconName.PersonAdd, Text = "Add Teacher", ParentId = "20" },

			new NavItem { Id = "30", Text = "Admins" },
			new NavItem { Id = "31", Href = "/admins", Match = NavLinkMatch.All, IconName = IconName.Table, Text = "View Admins", ParentId = "30" },
			new NavItem { Id = "32", Href = "/admins/add", Match = NavLinkMatch.All, IconName = IconName.PersonAdd, Text = "Add Admin", ParentId = "30" },

			new NavItem { Id = "40", Text = "Database" },
			new NavItem { Id = "41", ParentId = "40", Text = "Classes", Href = "/db/classes", Match = NavLinkMatch.All, IconName = IconName.ListTask },
			new NavItem { Id = "42", ParentId = "40", Text = "Inactive Users", Href = "/db/inactive-users", Match = NavLinkMatch.All, IconName = IconName.PersonDash },
			new NavItem { Id = "43", ParentId = "40", Text = "Request Logs", Href = "/db/request-logs", Match = NavLinkMatch.All, IconName = IconName.ListColumnsReverse },
			new NavItem { Id = "44", ParentId = "40", Text = "Default Admin", Href = "/db/default-admin", Match = NavLinkMatch.All, IconName = IconName.PersonGear },
			new NavItem { Id = "45", ParentId = "40", Text = "Import/Export", Href = "/db/import-export", Match = NavLinkMatch.All, IconName = IconName.DatabaseGear },

			new NavItem { Id = "99", Href = "/logout", IconName = IconName.DoorOpen, Text = "Logout" },
		};

		return navItems;
	}

	protected override void OnInitialized()
	{
		isAuthenticated = ApiRequests.IsAuthenticated;
		ApiRequests.AuthenticationStateChanged += OnAutheticationChanged;
	}

	private void OnAutheticationChanged()
	{
		isAuthenticated = ApiRequests.IsAuthenticated;
		StateHasChanged();
	}
}

